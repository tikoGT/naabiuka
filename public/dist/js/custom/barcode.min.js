'use strict';if($(".main-body .page-wrapper").find("#barcode-generate-container").length){function a(a,b){var c;for(c=0;c<b.length;c++)if(b[c]==a)return!0;return!1}function b(a,b,c){if(""==$("#vendor_id").val()||""==$("#from_location_id").val())return $("#error_message").text(jsLang("Please select vendor & origin first")),!1;$("#error_message").text("");$.ajax({url:c,dataType:"json",type:"POST",data:{_token:token,search:a.term,vendorId:$("#vendor_id").val(),fromLocationId:$("#from_location_id").val()},success:function(a){if(1==a.status){var a=a.products;$("#no_div").css("display","none"),b($.map(a,function(a){return{id:a.id,value:a.name,sku:a.sku,slug:a.slug}}))}else $(".ui-menu-item").remove(),$("#no_div").css("top",$("#search").position().top+35),$("#no_div").css("left",$("#search").position().left),$("#no_div").css("width",$("#search").width()),$("#no_div").css("display","block")}})}function c(){0==$(".closeRow").length?(stack=[],$("#product-table").addClass("display_none")):$("#product-table").removeClass("display_none")}stack=JSON.parse(stack),c(),$("#search").autocomplete({delay:500,position:{my:"left top",at:"left bottom",collision:"flip"},source:function(a,c){b(a,c,SITE_URL+"/barcode/product-search")},select:function(b,d){var f=d.item;if(f.id){if(!a(f.id,stack)){stack[f.id]=f.id;var e=`<tbody id="rowId-${rowNo}">
                          <input type="hidden" name="product_id[]" value="${f.id}">
                          <input type="hidden" name="product_slug[]" value="${f.slug}">
                          <input type="hidden" name="product_name[]" value="${f.value}">
                          <tr class="itemRow rowNo-${rowNo}" id="productId-${f.id}"  data-row-no="${rowNo}">
                              <td class="pl-1">
                                  <a href="${HomePageUrl+"/products/"+f.slug}" target="_blank">${f.value}</a>
                              </td>
                              
                              <td class="sku">
                                  <input id="sku_${rowNo}" name="product_sku[]" class="form-control text-center" type="text" readonly value="${f.sku}">
                              </td>
                              
                              <td class="productQty">
                                  <input name="product_qty[${f.id}]" id="product_qty_${rowNo}" class="inputQty form-control text-center" type="number" value="1" data-rowId = ${rowNo}>
                              </td>
                              <td class="text-center" style="padding-top: 15px !important;">
                                  <a href="javascript:void(0)" class="closeRow" data-row-id="${rowNo}" data-id = "${f.id}"><i class="feather icon-trash"></i></a>
                              </td>
                          </tr>
                          
                      </tbody>`;$("#product-table").append(e),c(),rowNo++}return $("#productId-"+f.id).find(".inputQty").trigger("blur"),!1}},minLength:1,autoFocus:!0}).autocomplete("instance")._renderItem=function(b,c){return a(c.id,stack)?$("<li style='pointer-events:none;opacity:0.6;'>").append("<div>"+c.value+"</div>").appendTo(b):$("<li>").append("<div>"+c.value+"</div>").appendTo(b)},$(document).on("click",".closeRow",function(a){a.preventDefault();let b="#rowId-"+$(this).attr("data-row-id"),d=$(this).attr("data-id"),e=0;for($(b).remove(),e=0;e<stack.length;e++)stack[e]==d&&stack.splice(e,1,0);c()}),$(document).ready(function(){$("#printBtn").on("click",function(){$("div.barcode").printArea({mode:"iframe",popClose:!1})})})}
