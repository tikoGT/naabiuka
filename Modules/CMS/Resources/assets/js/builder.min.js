"use strict";var pendingForm;const alertBox=$(".js-alert");$(function(){$("#sortable").sortable({axis:"y",cursor:"move",cancel:".dd-content"})}),$(document).on("submit","form#layout_selector",function(a){a.preventDefault();let b=this.action.replace("__file",this.querySelector("#l_layout").value);updateFormButton(this),ajaxRequest($(this),b,replaceForm)}),$(document).on("change",".category_type",function(){"selectedCategories"==this.value?this.closest("form").querySelector(".cats").classList.remove("d-none"):this.closest("form").querySelector(".cats").classList.add("d-none")}),$(document).on("change","#brand_type",function(){"selectedBrands"==this.value?this.closest("form").querySelector(".cats").classList.remove("d-none"):this.closest("form").querySelector(".cats").classList.add("d-none")}),$(document).on("change","#blog_type",function(){"selectedBlogs"==this.value?this.closest("form").querySelector(".cats").classList.remove("d-none"):this.closest("form").querySelector(".cats").classList.add("d-none")}),$(document).on("submit","form.component_form",function(a){a.preventDefault();let b=this.action.replace("__id",__page);updateFormButton(getDraggableParent(this)),$.makeAjaxCall($(this),b,{success:updateComponent,failed:updateComponent,type:"post"})}),$(document).on("keyup",".section_name",function(){let a=getDraggableParent(this);a.find(".header-title").html(filterXSS(this.value))}),$(document).on("click","#update_page",function(){if(0==$("#sortable").children().length)return void setTimeout(()=>{removeButtonLoader()},200);$(this).find(".loading-spinner").toggleClass("d-none");var a=0;$("#sortable").find("form.component_form").each(function(){let b=$(this).find("input,select,textarea").serialize();$("#internal_form").append(`<input type="hidden" class="temp-input" name="component[${a++}]" value="${b}">`)}),$.makeAjaxCall($("#internal_form"),__savePageUrl,{success:pageUpdated,type:"post"})}),$(document).on("click","#add-new-widget",function(){sortable.append(selector),$("html, body").animate({scrollTop:$(document).height()},"slow"),updateSelect2Fields()}),$(document).on("change","#l_category",function(){$(this).closest("form").find(".layoutBlocks").addClass("d-none"),$(this).closest("form").find("#"+this.value).removeClass("d-none")});const ajaxRequest=(a,b,c,d="get")=>{let e={};if(a){var f=a.find("input, select, button, textarea");a.serializeArray().forEach(a=>{let[b,c]=[a.name,a.value];b.endsWith("[]")?(b=b.slice(0,-2),!e[b]&&(e[b]=[]),e[b].push(c)):e[b]=c}),f.prop("disabled",!0)}pendingForm=a,$.ajax({url:b,type:d,dataType:"json",data:e,success:function(b){c(a,b.body),f.prop("disabled",!1),ajaxUpdated(),removeButtonLoader()},error:function(b,c,d){throw f.prop("disabled",!1),operationFailed(jsLang("Operation failed.")),updateAjaxMessage(a,jsLang("Operation failed."),"danger"),updateFormButton(a),ajaxFailed(),removeButtonLoader(),d}})},replaceForm=(a,b)=>{let c=getDraggableParent(a);c.find(".header-title").html(b.title),c.find(".header-text").append(b.header),c.attr("data-id",b.level),c.find(".dd-content").remove(),c.append(b.html),$("#sortable").trigger("sortstop"),$("#update_page .loading-spinner").toggleClass("d-none"),operationSuccess(jsLang("Section added. Please fill up the section information and save.")),updateSelect2Fields()},updateComponent=(a,b)=>{let c=$(a.form);c.closest(".ui-state-default").find(".delete-button").attr("data-component-id",b.body),c.find(".component").prop("value",b.body),updateFormButton(getDraggableParent(c)),updateAjaxMessage(getDraggableParent(c),jsLang("Section updated.")),operationSuccess(jsLang("Section Updated"))},getDraggableParent=a=>$(a).closest(".ui-state-default"),deletedGrid=a=>{a?operationSuccess(jsLang("Section deleted")):operationFailed(jsLang("Couldn't delete the section"))},updateCustomForm=a=>{document.querySelector("#internal_form #data").value=a},pageUpdated=()=>{$("#update_page .loading-spinner").toggleClass("d-none"),$(".temp-input").remove(),window.location.reload()},operationSuccess=a=>{showNotification("success",jsLang(a))},operationFailed=a=>{showNotification("danger",jsLang(a))},showNotification=(a,b)=>{alertBox.find(".alertText").html(b),alertBox.find(".alert").attr("class",`alert alert-${a}`),alertBox.removeClass("d-none")};$(".close").click(function(){alertBox.addClass("d-none")});const showSliderOptions=a=>{let b=getDraggableParent(a);$(b).find(".sliderOptions").removeClass("d-none").addClass("d-flex"),hideBannerOptions(b),hideFlashOptions(b)},hideSliderOptions=a=>{$(a).find(".sliderOptions").addClass("d-none").removeClass("d-flex")},showBannerOptions=a=>{let b=getDraggableParent(a);$(b).find(".bannerOptions").removeClass("d-none").addClass("d-flex"),hideSliderOptions(b),hideFlashOptions(b)},hideBannerOptions=a=>{$(a).find(".bannerOptions").removeClass("d-flex").addClass("d-done")},showFlashOptions=a=>{let b=getDraggableParent(a);$(b).find(".flashOptions").addClass("d-flex").removeClass("d-none"),hideSliderOptions(b),hideBannerOptions(b)},hideFlashOptions=a=>{$(a).find(".flashOptions").addClass("d-none").removeClass("d-flex")},hideAllOptions=a=>{let b=getDraggableParent(a);hideSliderOptions(b),hideBannerOptions(b),hideFlashOptions(b),toggleSidebar(a,!1)},updateSelect2Fields=()=>{$("select.select2").select2({placeholder:jsLang("Select an option")}),$(".select3").select2({placeholder:jsLang("Select an option")})};$(document).on("select2:select","select.select2",function(a){var b=a.params.data.element,c=$(b);c.detach(),$(this).append(c),$(this).trigger("change")}),updateSelect2Fields(),$(document).on("change",".sidebar_options",function(){"0"==this.value?hideAllOptions(this):"slide"==this.value?(showBannerOptions(this),toggleSidebar(this,!0)):"slider"==this.value?(showSliderOptions(this),toggleSidebar(this,!0)):"flash_sale"==this.value&&(showFlashOptions(this),toggleSidebar(this,!0)),$(".product-col").trigger("change")}),$(document).ready(function(){updateSelect2Fields(),$(".select2").on("select2:select",function(a){var b=a.params.data.element,c=$(b);c.detach(),$(this).append(c),$(this).trigger("change")})}),$(document).on("click",".folding",function(){let a=this.closest(".ui-state-default");this.classList.contains("closed")?($(a).find(".dd-content").removeClass("card-hide"),$(this).removeClass("closed")):($(a).find(".dd-content").addClass("card-hide"),$(this).addClass("closed"))}),$(document).on("click",".header-text",function(){$(this).closest(".ui-state-default").find(".folding").trigger("click")}),$(document).on("click",".delete-button",function(){$("#component-title").html(filterXSS($(this).data("component"))),deletingSection=this.closest(".ui-state-default"),deletingSectionId=$(this).data("component-id")}),$(document).on("click",".delete-section-btn",function(){toggleDeleteLoading(),updateCustomForm(deletingSectionId),"0"===deletingSectionId||0===deletingSectionId?gridDeleted(null,!0):ajaxRequest($("#internal_form"),__gridDeleteUrl,gridDeleted,"post")});const toggleDeleteLoading=()=>{$(".delete-loading").toggleClass("d-none")},gridDeleted=(a,b)=>{$(".modal").modal("hide"),toggleDeleteLoading(),$(".delete-section-btn .spinner-border").remove(),$(".delete-section-btn").removeClass("disabled-btn"),$(".delete-section-btn").text(jsLang("Delete")),b?(deletingSection.remove(),operationSuccess("Section deleted")):operationFailed("Section couldn't be deleted."),deletingSection=void 0,deletingSectionId=void 0},updateFormButton=a=>{$(a).find(".loading-spinner").toggleClass("d-none"),$("#update_page .loading-spinner").toggleClass("d-none")},updateAjaxMessage=(a,b,c="success")=>{$(a).find(".message").html(b),$(a).find(".message").addClass(`text-${c}`),setTimeout(a=>{$(a).find(".message").html("")},3e3)};$(".img-delete-icon").click(function(){let a=$(this).closest(".form-group");$(a).find(".custom-file-input").val(""),$(this).closest(".preview-image").html("")});const toggleSidebar=(a,b=!0)=>{let c=getDraggableParent(a);b?$(c).find(".sidebarOption").removeClass("d-none"):$(c).find(".sidebarOption").addClass("d-none")};$(document).on("change",".seeMore",function(){let a=getDraggableParent(this);$(a).find(".moreLink").toggleClass("d-none")}),$(document).on("click",".selectable",function(){$(this).closest("form").find(".selectable").removeClass("selectedBox"),$(this).closest("form").find("#l_layout").val($(this).data("val")),$(this).addClass("selectedBox")}),$(document).on("file-attached",".media-manager",function(a,b){let c=b.data[0],d=$(this).data("name");$($(this).closest(".form-group")).find(".preview-image").html(imagePreview(c,d))});const imagePreview=(a,b)=>`<div class="d-flex flex-wrap mt-2">
                <div class="position-relative border boder-1 media-box p-1 mr-2 rounded mt-2">
                    <div class="position-absolute rounded-circle text-center img-remove-icon"><i class="fa fa-times"></i>
                    </div>
                    <img class="upl-img neg-transition-scale" class="p-1"
                        src="${a.url}" alt="">
                    <input type="hidden" name="${b}" value="${a.path}">
                </div>
            </div>`;$("#sortable").on("sortstop",function(){let a=$("#sortable").sortable("toArray",{attribute:"data-id"});a.forEach((a,b)=>{$(`.${a}`).val(b+1)})});const addRowButton=(a,b)=>`<span class="accordion-row-action add-row-btn" data-parent="${b}" data-index="${a}"><i class="feather icon-plus"></i>
        </span>`,removeRowButton=(a,b)=>`<span class="accordion-row-action remove-row-btn" data-parent="${b}" data-index="${a+1}"><i class="feather icon-minus"></i>
    </span>`,getCtaForm=(a,b)=>{let c=getRandomString("id_");return`<div class="card cta-card mb-3">
                <div class="card-header p-2" id="headingOne">
                    <div class="mb-0 ac-switch d-flex closed justify-content-between align-items-center w-full curson-pointer" data-bs-toggle="collapse" data-bs-target="#${c}" aria-expanded="true" aria-controls="${c}">
                        <div>${jsLang("Call To Action")}</div>
                        <span class="b-icon">
                            <i class="feather icon-chevron-down collapse-status"></i>
                            <span class="accordion-action-group">
                                <span class="accordion-row-action remove-row-btn"
                                    data-index="${a+1}" data-parent="${b}" data-parent="${b}"><i
                                        class="feather icon-minus"></i></span>
                                <span class="accordion-row-action add-row-btn" data-index="${a+1}" data-parent="${b}">
                                    <i class="feather icon-plus"></i>
                                </span>
                            </span>
                        </span>
                    </div>
                </div>
                <div id="${c}" class="card-body parent-class collapse show" aria-labelledby="headingOne" data-parent=".${b}" style="">
                    <div class="form-group row">
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Upper Subtitle")}</label>
                                <div class="col-sm-12">
                                    <input type="text" class="form-control inputFieldDesign" value="" name="cta[${a}][upper_st]">
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Lower Subtitle")}</label>
                                <div class="col-sm-12">
                                    <input type="text" class="form-control inputFieldDesign" value="" name="cta[${a}][lower_st]">
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Title")}</label>
                                <div class="col-sm-12">
                                    <input type="text" class="form-control inputFieldDesign" value="" name="cta[${a}][title]">

                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Image")}</label>
                                <div class="col-md-12">
                                    <div class="custom-file media-manager" data-val="single" id="image-status" data-name="cta[${a}][image]">
                                        <input class="custom-file-input form-control d-none inputFieldDesign" id="validatedCustomFile${uniqueNumber}" maxlength="50" accept="image/*" value="">
                                        <label class="custom-file-label overflow_hidden position-relative d-flex align-items-center" for="validatedCustomFile${uniqueNumber}">${jsLang("Upload image")}</label>
                                    </div>
                                    <div class="preview-image">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Button Text")}</label>
                                <div class="col-sm-12">
                                    <input type="text" class="form-control inputFieldDesign" value="" name="cta[${a}][btn_text]">
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Button Link")}</label>
                                <div class="col-sm-12">
                                    <input type="text" class="form-control inputFieldDesign" value="" name="cta[${a}][btn_link]">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>`},getSliderForm=(a,b)=>{let c=getRandomString("id_");return`<div class="card cta-card mb-3">
                <div class="card-header p-2" id="headingOne">
                    <div class="mb-0 ac-switch d-flex closed justify-content-between align-items-center w-full curson-pointer collapsed" data-bs-toggle="collapse" data-bs-target="#${c}" aria-expanded="false" aria-controls="${c}">
                        <div>${jsLang("Slider")}</div>
                        <span class="b-icon">
                            <i class="feather icon-chevron-down collapse-status"></i>
                            <span class="accordion-action-group">
                                <span class="accordion-row-action remove-row-btn"
                                    data-index="${a+1}" data-parent="${b}" data-parent="${b}"><i
                                        class="feather icon-minus"></i></span>
                                <span class="accordion-row-action add-row-btn" data-index="${a+1}" data-parent="${b}">
                                    <i class="feather icon-plus"></i>
                                </span>
                            </span>
                        </span>
                    </div>
                </div>
                <div id="${c}" class="card-body collapse" aria-labelledby="headingOne" data-parent=".${b}" style="">
                    <div class="form-group row">
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Upper Subtitle")}</label>
                                <div class="col-sm-12">
                                    <input type="text" class="form-control inputFieldDesign" name="slider[${a}][u_subtitle]">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Lower Subtitle")}</label>
                                <div class="col-sm-12">
                                    <input type="text" class="form-control inputFieldDesign" name="slider[${a}][l_subtitle]">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 row parent-class m-0 p-0">
                            <div class="col-md-6">
                                <div class="form-group row">
                                    <label class="col-sm-12 control-label">${jsLang("Title")}</label>
                                    <div class="col-sm-12">
                                        <input type="text" class="form-control inputFieldDesign" name="slider[${a}][title]">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group row">
                                    <label class="col-sm-12 control-label">${jsLang("Image")}</label>
                                    <div class="col-sm-12">
                                        <div class="custom-file media-manager" data-name="slider[${a}][image]" data-val="single" id="image-status">
                                            <input class="custom-file-input form-control d-none inputFieldDesign" id="validatedCustomFile${uniqueNumber}" maxlength="50" accept="image/*">
                                            <label class="custom-file-label overflow_hidden position-relative d-flex align-items-center" for="validatedCustomFile${uniqueNumber}">${jsLang("Upload image")}</label>
                                        </div>
                                        <div class="preview-image">

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Button Text")}</label>
                                <div class="col-sm-12">
                                    <input type="text" class="form-control inputFieldDesign" value="" name="slider[${a}][button_text]">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Link")}</label>
                                <div class="col-sm-12">
                                    <input type="text" class="form-control inputFieldDesign" value="" name="slider[${a}][button_link]">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>`},getIconboxForm=(a,b)=>{let c=getRandomString("id_");return`<div class="card cta-card mb-3">
                <div class="card-header p-2" id="headingOne">
                    <div class="mb-0 ac-switch d-flex closed justify-content-between align-items-center w-full curson-pointer" data-bs-toggle="collapse" data-bs-target="#${c}" aria-expanded="true" aria-controls="${c}">
                        <div>${jsLang("Icon Box")}</div>
                        <span class="b-icon">
                            <i class="feather icon-chevron-down collapse-status"></i>
                            <span class="accordion-action-group">
                                <span class="accordion-row-action remove-row-btn"
                                    data-index="${a+1}" data-parent="${b}" data-parent="${b}"><i
                                        class="feather icon-minus"></i></span>
                                <span class="accordion-row-action add-row-btn" data-index="${a+1}" data-parent="${b}">
                                    <i class="feather icon-plus"></i>
                                </span>
                            </span>
                        </span>
                    </div>
                </div>
                <div id="${c}" class="card-body parent-class collapse show" aria-labelledby="headingOne" data-parent=".${b}" style="">
                    <div class="form-group row">
                        <div class="col-md-12">
                            <div class="form-group row">
                                <div class="col-md-12">
                                    <div class="preview-image">
                                    </div>
                                </div>
                                <label class="col-sm-12 control-label">${jsLang("Icon")}</label>
                                <div class="col-md-12">
                                    <div class="custom-file media-manager" data-name="iconbox[${a}][image]" data-val="single" id="image-status">
                                        <input class="custom-file-input form-control d-none inputFieldDesign" id="validatedCustomFile${uniqueNumber}" maxlength="50" value="">
                                        <label class="custom-file-label overflow_hidden position-relative d-flex align-items-center" for="validatedCustomFile${uniqueNumber}">Upload image</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Title")}</label>
                                <div class="col-sm-12">
                                    <input type="text" class="form-control inputFieldDesign" value="" name="iconbox[${a}][title]">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group row">
                                <label class="col-sm-12 control-label">${jsLang("Subtitle")}</label>
                                <div class="col-sm-12">
                                    <input type="text" class="form-control inputFieldDesign" value="" name="iconbox[${a}][subtitle]">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>`};var uniqueNumber=11111111;$(document).on("click",".add-row-btn",function(a){if($(this).hasClass("__private"))return;a.stopPropagation();let b=parseInt($(this).data("index")),c=$(this).data("parent");0==$(this).closest(".accordion-action-group").find(".remove-row-btn").length&&$(removeRowButton(b,c)).insertAfter($(this)),uniqueNumber++,0<$(this).closest(".cta-accordion").length?$(this).closest(".cta-accordion").append(getCtaForm(b,c)):0<$(this).closest(".slider-accordion").length?$(this).closest(".slider-accordion").append(getSliderForm(b,c)):0<$(this).closest(".iconbox-accordion").length&&$(this).closest(".iconbox-accordion").append(getIconboxForm(b,c)),$(this).remove()}),$(document).on("click",".remove-row-btn",function(){if(!$(this).hasClass("__private")){if(0<$(this).closest(".accordion-action-group").find(".add-row-btn").length){let a=parseInt($(this).data("index")),b=$(this).data("parent"),c=$(this).closest(".cta-card").prev().find(".accordion-action-group");c.append(addRowButton(a,b))}let a=$(this).closest(".accordion").children();$(this).closest(".cta-card").remove(),2===a.length&&a.find(".remove-row-btn").remove()}});const getRandomString=(a="")=>a+(Math.random()+1).toString(36).substring(7);jQuery.extend({makeAjaxCall:function(a,b,c={},d={}){let{defaults:e,data:f}={defaults:{type:"get",dataType:"json",processData:!1,contentType:"json",success:defaultResponseHandler,failed:defaultResponseHandler,callbackParam:!1,formdata:!1},data:{_token:token,data:a.find("input,select,textarea").serialize()}};e.callbackParam={form:a},$("input,textarea,select").prop("disabled",!0),e=Object.assign({},e,c),f=e.formdata?e.formdata:Object.assign({},f,d),$.ajax({url:b,type:e.type,dataType:e.dataType,data:f,success:function(a){e.success(e.callbackParam,a),ajaxUpdated()},error:function(a,b,c){e.failed(a,b,c),ajaxFailed()},complete:function(){removeButtonLoader()}})}});const defaultResponseHandler=()=>{unblockEverything()},ajaxUpdated=()=>{triggerNotification(jsLang("Action completed."))},ajaxFailed=()=>{triggerNotification(jsLang("Request failed. Check network tab for details."))},triggerNotification=a=>{$(".notification-msg-bar").find(".notification-msg").html(a),$(".notification-msg-bar").removeClass("smoothly-hide"),setTimeout(()=>{$(".notification-msg-bar").addClass("smoothly-hide"),$(".notification-msg-bar").find(".notification-msg").html("")},1500)};$(document).on("click",".has-spinner-loader",function(){$(this).append("<div class=\"spinner-border spinner-border-sm ml-2\" role=\"status\"><span class=\"sr-only\">Loading...</span></div>"),$(this).addClass("disabled-btn")});const removeButtonLoader=()=>{$(".has-spinner-loader").removeClass("disabled-btn"),$(".spinner-border").remove(),$(".spinner-border-sm").remove(),$("input,textarea,select").prop("disabled",!1)};$(document).on("change",".product-type",function(){"queryProducts"==$(this).val()?$(this).closest(".component_form").find(".queryOptions").addClass("d-flex").removeClass("d-none"):$(this).closest(".component_form").find(".queryOptions").addClass("d-none").removeClass("d-flex")}),$(document).on("change",".product-col, .product-row",function(){let a=$(this).closest(".product-count").find(".product-row").val(),b=$(this).closest(".product-count").find(".product-col").val();a&&12<a?a=12:a&&0>=a&&(a=1),b&&12<b?b=12:b&&0>=b&&(b=1),$(this).closest(".product-count").find(".product-row").prop("value",a),$(this).closest(".product-count").find(".product-col").prop("value",b);let c=a*b;"flash_sale"==$(this).closest(".component_form").find(".sidebar_options").val()&&c++,$(this).closest(".product-count").find(".product-quantity").prop("value",c)});
